{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "motion-dock",
  "type": "registry:block",
  "title": "Motion Dock",
  "description": "A reusable component where tooltips slide smoothly between dock items, making the motion dock feel natural and easy to use.",
  "dependencies": [
    "motion",
    "clsx",
    "tw-merge"
  ],
  "files": [
    {
      "path": "components/(package)/motion-dock/motion-dock.tsx",
      "content": "\"use client\";\r\n\r\nimport React from \"react\";\r\nimport {\r\n  useAnimate,\r\n  motion,\r\n  AnimatePresence,\r\n  usePresence,\r\n  useMotionValue,\r\n  type Transition,\r\n  type AnimationPlaybackControlsWithThen,\r\n  type HTMLMotionProps,\r\n} from \"motion/react\";\r\n\r\nimport { usePrevious } from \"@/hooks/use-previous\";\r\nimport { useDebouncedState } from \"@/hooks/use-debounced-state\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface DockItem extends Omit<HTMLMotionProps<\"button\">, \"ref\"> {\r\n  icon: React.ReactElement;\r\n  tooltip: string;\r\n}\r\n\r\nexport interface MotionDockProps extends React.ComponentProps<\"div\"> {\r\n  dockItems: DockItem[];\r\n  tooltipBorderRadius?: React.CSSProperties[\"borderRadius\"];\r\n}\r\nconst TRANSITION: Transition = {\r\n  duration: 0.2,\r\n  ease: [0.76, 0, 0.24, 1], // easeInOutQuart\r\n};\r\nexport function MotionDock({\r\n  dockItems,\r\n  className,\r\n  tooltipBorderRadius = \"var(--radius-sm,4px)\",\r\n  ...rest\r\n}: MotionDockProps) {\r\n  const [activeItem, setActiveItem] = useDebouncedState<number>(-1, 100);\r\n  const dockRef = React.useRef<HTMLDivElement>(null);\r\n\r\n  const handleReset = () => setActiveItem(-1);\r\n\r\n  return (\r\n    <div className={cn(className, \"!relative !w-fit\")} {...rest}>\r\n      <div\r\n        ref={dockRef}\r\n        className=\"bg-background text-foregroud border-border flex gap-0.5 rounded-full border p-1 shadow-sm\"\r\n        onMouseLeave={handleReset}\r\n        onBlurCapture={handleReset}\r\n      >\r\n        {dockItems.map(\r\n          ({ icon, tooltip, onMouseEnter, onFocus, className, ...rest }, i) => (\r\n            <motion.button\r\n              key={tooltip}\r\n              aria-label={tooltip}\r\n              onFocus={(e) => {\r\n                setActiveItem(i);\r\n                onFocus?.(e);\r\n              }}\r\n              onMouseEnter={(e) => {\r\n                setActiveItem(i);\r\n                onMouseEnter?.(e);\r\n              }}\r\n              data-dockitem={i}\r\n              className={cn(\r\n                \"hover:text-accent-foreground hover:bg-accent focus-visible:text-accent-foreground focus-visible:bg-accent focus-visible:ring-ring focus-visible:ring-offset-background cursor-pointer rounded-full p-1.5 transition-colors duration-150 ease-out focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-none [&>svg]:size-4.5\",\r\n                className,\r\n              )}\r\n              {...rest}\r\n            >\r\n              {icon}\r\n            </motion.button>\r\n          ),\r\n        )}\r\n      </div>\r\n      <AnimatePresence>\r\n        {activeItem >= 0 && (\r\n          <ToolTipsContainer\r\n            activeItem={activeItem}\r\n            dockRef={dockRef as React.RefObject<HTMLDivElement>}\r\n            tooltips={dockItems.map(({ tooltip }) => tooltip)}\r\n            tooltipBorderRadius={tooltipBorderRadius}\r\n          />\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface TooltipsContainerProps {\r\n  dockRef: React.RefObject<HTMLDivElement>;\r\n  activeItem: number;\r\n  tooltips: string[];\r\n  tooltipBorderRadius: React.CSSProperties[\"borderRadius\"];\r\n}\r\nfunction ToolTipsContainer({\r\n  dockRef,\r\n  activeItem,\r\n  tooltips,\r\n  tooltipBorderRadius,\r\n}: TooltipsContainerProps) {\r\n  const prevMouseIn = usePrevious<number>(activeItem);\r\n  const [isPresent, safeToRemove] = usePresence();\r\n  const [tooltipContainerScope, animate] = useAnimate();\r\n  const x = useMotionValue(0);\r\n\r\n  const getTranslateX = React.useCallback(\r\n    (activeItem: number) => {\r\n      const hoverDockItem = dockRef.current.querySelector(\r\n        `[data-dockitem=\"${activeItem}\"]`,\r\n      );\r\n      const { left: hoverDockItemLeft, width: hoverDockItemWidth } =\r\n        hoverDockItem!.getBoundingClientRect();\r\n      const finalPosition = hoverDockItemLeft + hoverDockItemWidth / 2;\r\n\r\n      const correspondingTooltip = tooltipContainerScope.current.querySelector(\r\n        `[data-tooltip=\"${activeItem}\"]`,\r\n      );\r\n      const { left: tooltipLeft, width: tooltipWidth } =\r\n        correspondingTooltip!.getBoundingClientRect();\r\n      const currentPosition = tooltipLeft + tooltipWidth / 2;\r\n\r\n      const relativeTranslateX = finalPosition - currentPosition;\r\n      const translateX = relativeTranslateX + x.get();\r\n      return translateX;\r\n    },\r\n    [x, dockRef, tooltipContainerScope],\r\n  );\r\n\r\n  const getClipPath = React.useCallback(\r\n    (activeItem: number) => {\r\n      let left = 0;\r\n      let right = 0;\r\n      for (let j = 0; j < tooltips.length; j++) {\r\n        const { width } = tooltipContainerScope.current\r\n          .querySelector(`[data-tooltip=\"${j}\"]`)\r\n          .getBoundingClientRect();\r\n        if (j < activeItem) {\r\n          left += width;\r\n        } else if (j > activeItem) {\r\n          right += width;\r\n        }\r\n      }\r\n      const clipPath = `inset(0px ${right}px 0px ${left}px round ${tooltipBorderRadius}`;\r\n\r\n      return clipPath;\r\n    },\r\n    [tooltips.length, tooltipContainerScope, tooltipBorderRadius],\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    let control: AnimationPlaybackControlsWithThen | undefined = undefined;\r\n    if (isPresent) {\r\n      const keyframes = {\r\n        clipPath: getClipPath(activeItem),\r\n        x: getTranslateX(activeItem),\r\n      };\r\n      if (prevMouseIn === undefined) {\r\n        const enterAnimation = async () => {\r\n          if (typeof control !== \"undefined\") {\r\n            control.stop();\r\n          }\r\n          await animate(tooltipContainerScope.current, keyframes, {\r\n            duration: 0,\r\n          });\r\n          await animate(\r\n            tooltipContainerScope.current,\r\n            { opacity: 1 },\r\n            TRANSITION,\r\n          );\r\n        };\r\n        enterAnimation();\r\n      } else {\r\n        const intermediateAnimation = () => {\r\n          animate(tooltipContainerScope.current, keyframes, TRANSITION);\r\n        };\r\n        intermediateAnimation();\r\n      }\r\n    } else {\r\n      const exitAnimation = async () => {\r\n        control = await animate(\r\n          tooltipContainerScope.current,\r\n          { opacity: 0 },\r\n          TRANSITION,\r\n        );\r\n        safeToRemove();\r\n      };\r\n      exitAnimation();\r\n    }\r\n  }, [\r\n    animate,\r\n    safeToRemove,\r\n    isPresent,\r\n    prevMouseIn,\r\n    activeItem,\r\n    getClipPath,\r\n    getTranslateX,\r\n    tooltipContainerScope,\r\n  ]);\r\n\r\n  return (\r\n    <motion.div\r\n      ref={tooltipContainerScope}\r\n      initial={{\r\n        opacity: 0,\r\n      }}\r\n      style={{\r\n        x,\r\n      }}\r\n      className=\"bg-primary text-primary-foreground absolute bottom-[calc(100%_+_var(--spacing)_*_1)] flex flex-nowrap py-1 text-xs\"\r\n    >\r\n      {tooltips.map((tooltip, i) => (\r\n        <div\r\n          key={tooltip}\r\n          className=\"px-2 text-nowrap whitespace-nowrap\"\r\n          data-tooltip={i}\r\n        >\r\n          {tooltip}\r\n        </div>\r\n      ))}\r\n    </motion.div>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    },
    {
      "path": "lib/utils.ts",
      "content": "import { clsx, type ClassValue } from \"clsx\";\r\nimport { twMerge } from \"tailwind-merge\";\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n",
      "type": "registry:lib"
    },
    {
      "path": "hooks/use-debounced-state.ts",
      "content": "import React from \"react\";\r\n\r\nexport function useDebouncedState<T>(initialValue: T, delay: number) {\r\n  const [state, setState] = React.useState(initialValue);\r\n  const timeoutRef = React.useRef<NodeJS.Timeout>(undefined);\r\n\r\n  const setDebouncedState = React.useCallback(\r\n    (newState: T) => {\r\n      clearTimeout(timeoutRef.current);\r\n      timeoutRef.current = setTimeout(() => setState(newState), delay);\r\n    },\r\n    [delay],\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    return () => clearTimeout(timeoutRef.current);\r\n  }, []);\r\n\r\n  return [state, setDebouncedState] as const;\r\n}\r\n",
      "type": "registry:hook"
    },
    {
      "path": "hooks/use-previous.ts",
      "content": "import React from \"react\";\r\n\r\nexport function usePrevious<T>(state: T): T | undefined {\r\n  const prevState = React.useRef<T | undefined>(undefined);\r\n  React.useEffect(() => {\r\n    prevState.current = state;\r\n  }, [state]);\r\n  return prevState.current;\r\n}\r\n",
      "type": "registry:hook"
    }
  ]
}